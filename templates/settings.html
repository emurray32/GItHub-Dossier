{% extends "base.html" %}

{% block title %}Settings{% endblock %}
{% block page_title %}Settings{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/settings.css') }}?v={{ cache_bust }}">
{% endblock %}

{% block content %}
<div class="settings-container">
    <p class="settings-subtitle">Tools, configuration, and scanning management</p>

    <!-- Active Tools -->
    <div class="settings-section">
        <div class="settings-list">

            <a href="{{ url_for('history') }}" class="settings-row">
                <div class="settings-row-icon settings-row-icon--indigo">
                    <i data-lucide="radar"></i>
                </div>
                <div class="settings-row-body">
                    <div class="settings-row-title">Scan History</div>
                    <div class="settings-row-desc">Browse previous deep-dive scans across all tracked accounts</div>
                </div>
                <span class="settings-row-meta" id="settingsScanMeta"></span>
                <i data-lucide="chevron-right" class="settings-row-chevron"></i>
            </a>

            <a href="{{ url_for('rules') }}" class="settings-row">
                <div class="settings-row-icon settings-row-icon--emerald">
                    <i data-lucide="sliders-horizontal"></i>
                </div>
                <div class="settings-row-body">
                    <div class="settings-row-title">Scanning Rules</div>
                    <div class="settings-row-desc">Tune intent score weights, Goldilocks thresholds, and signal keyword patterns</div>
                </div>
                <span class="settings-row-meta" id="settingsRulesMeta"></span>
                <i data-lucide="chevron-right" class="settings-row-chevron"></i>
            </a>

        </div>
    </div>

    <!-- Experimental -->
    <div class="settings-section">
        <div class="settings-section-label">Experimental</div>
        <div class="settings-list settings-list--muted">

            <a href="{{ url_for('webscraper_accounts') }}" class="settings-row">
                <div class="settings-row-icon settings-row-icon--slate">
                    <i data-lucide="scan-search"></i>
                </div>
                <div class="settings-row-body">
                    <div class="settings-row-title">WebScraper
                        <span class="settings-exp-tag">Beta</span>
                    </div>
                    <div class="settings-row-desc">Crawl target websites to detect locale selectors, hreflang tags, and translation vendor scripts</div>
                </div>
                <span class="settings-row-meta" id="settingsWebMeta"></span>
                <i data-lucide="chevron-right" class="settings-row-chevron"></i>
            </a>

            <a href="{{ url_for('experiment') }}" class="settings-row">
                <div class="settings-row-icon settings-row-icon--slate">
                    <i data-lucide="flask-conical"></i>
                </div>
                <div class="settings-row-body">
                    <div class="settings-row-title">Analyzer
                        <span class="settings-exp-tag">Beta</span>
                    </div>
                    <div class="settings-row-desc">Run custom scoring models and exploratory queries against scanned repo data</div>
                </div>
                <i data-lucide="chevron-right" class="settings-row-chevron"></i>
            </a>

            <a href="{{ url_for('scorecard') }}" class="settings-row">
                <div class="settings-row-icon settings-row-icon--slate">
                    <i data-lucide="award"></i>
                </div>
                <div class="settings-row-body">
                    <div class="settings-row-title">ScoreCard
                        <span class="settings-exp-tag">Beta</span>
                    </div>
                    <div class="settings-row-desc">Visual scorecard for account readiness and engagement metrics</div>
                </div>
                <i data-lucide="chevron-right" class="settings-row-chevron"></i>
            </a>

        </div>
    </div>

</div>

<script>
// Populate inline stats for settings rows
(function() {
    fetch('/api/history/stats')
        .then(function(r) { return r.ok ? r.json() : null; })
        .then(function(d) {
            if (d && d.total !== undefined) {
                var el = document.getElementById('settingsScanMeta');
                if (el) el.textContent = d.total + ' reports';
            }
        }).catch(function(){});

    fetch('/api/webscraper/stats')
        .then(function(r) { return r.ok ? r.json() : null; })
        .then(function(d) {
            if (d && d.total !== undefined) {
                var el = document.getElementById('settingsWebMeta');
                if (el) el.textContent = d.total + ' accounts';
            }
        }).catch(function(){});
})();
</script>
{% endblock %}
